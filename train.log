2021-09-24 20:10:03,312 __main__     INFO     START predict.py
2021-09-24 20:10:03,315 __main__     INFO     Load test df
2021-09-24 20:10:03,381 __main__     INFO     Input shape: (2974, 76)
2021-09-24 20:10:03,389 __main__     INFO     Load model
2021-09-24 20:10:03,646 __main__     INFO     Predict
2021-09-24 20:10:04,081 __main__     INFO     Save results
2021-09-24 20:10:04,141 __main__     INFO     END predict.py
2021-09-24 21:51:28,590 __main__     INFO     START train.py
2021-09-24 21:51:28,591 __main__     INFO     Load train df
2021-09-24 21:51:30,717 __main__     INFO     Input shape: (279792, 77)
2021-09-24 21:51:31,686 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 21:51:31,687 __main__     INFO     Fit model
2021-09-24 21:51:31,687 raifhack_ds.model INFO     Fit lightgbm
2021-09-24 21:53:36,756 raifhack_ds.model INFO     Find corr coefficient
2021-09-24 21:53:37,567 raifhack_ds.model INFO     Corr coef: -0.12
2021-09-24 21:53:37,568 __main__     INFO     Save model
2021-09-24 21:54:30,644 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204271589249925, 'mdape': 0.3125603548666643, 'rmse': 73946.13496006273, 'r2': 0.8172816627975483, 'raif_metric': 3.4943808614617957}
2021-09-24 21:54:31,464 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30544381035322893, 'mdape': 0.24759116446089766, 'rmse': 73135.9256925428, 'r2': 0.3308659827460806, 'raif_metric': 2.0449581821903826}
2021-09-24 21:54:31,464 __main__     INFO     END train.py
2021-09-24 21:57:51,406 __main__     INFO     START train.py
2021-09-24 21:57:51,407 __main__     INFO     Load train df
2021-09-24 21:57:53,380 __main__     INFO     Input shape: (279792, 77)
2021-09-24 21:57:54,190 __main__     INFO     X_offer (275299, 70)  y_offer (275299,)	X_manual (4493, 70) y_manual (4493,)
2021-09-24 21:57:54,190 __main__     INFO     Fit model
2021-09-24 21:57:54,190 raifhack_ds.model INFO     Fit lightgbm
2021-09-24 21:59:58,192 raifhack_ds.model INFO     Find corr coefficient
2021-09-24 21:59:58,996 raifhack_ds.model INFO     Corr coef: -0.12
2021-09-24 21:59:58,998 __main__     INFO     Save model
2021-09-24 22:00:55,127 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5204271589249925, 'mdape': 0.3125603548666643, 'rmse': 73946.13496006273, 'r2': 0.8172816627975483, 'raif_metric': 3.4943808614617957}
2021-09-24 22:00:56,082 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30544381035322893, 'mdape': 0.24759116446089766, 'rmse': 73135.9256925428, 'r2': 0.3308659827460806, 'raif_metric': 2.0449581821903826}
2021-09-24 22:00:56,082 __main__     INFO     END train.py
2021-09-24 22:34:39,577 __main__     INFO     START train.py
2021-09-24 22:34:39,578 __main__     INFO     Load train df
2021-09-24 22:34:41,770 __main__     INFO     Load validation df
2021-09-24 22:34:41,994 __main__     INFO     Input shape: (251812, 77)
2021-09-24 22:34:42,606 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (4100, 70) y_manual (4100,)
2021-09-24 22:34:42,660 __main__     INFO     Fit model
2021-09-24 22:34:42,660 raifhack_ds.model INFO     Fit lightgbm
2021-09-24 22:36:22,708 raifhack_ds.model INFO     Find corr coefficient
2021-09-24 22:36:23,427 raifhack_ds.model INFO     Corr coef: -0.12
2021-09-24 22:36:23,427 __main__     INFO     Save model
2021-09-24 22:37:10,630 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5043859971715596, 'mdape': 0.31014303690421474, 'rmse': 72948.89930537011, 'r2': 0.8241732340876078, 'raif_metric': 3.4705397780729785}
2021-09-24 22:37:11,391 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.30095564736217434, 'mdape': 0.25092149371349093, 'rmse': 76183.68968242845, 'r2': 0.3026649019988512, 'raif_metric': 2.0706593009820757}
2021-09-24 22:37:16,524 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6698596129156125, 'mdape': 0.32935958086730255, 'rmse': 85631.92215009569, 'r2': 0.7266249821132493, 'raif_metric': 3.654987172813648}
2021-09-24 22:37:16,608 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3626395055690544, 'mdape': 0.23478071176958018, 'rmse': 43810.10250281943, 'r2': 0.5787374262925938, 'raif_metric': 1.832304230991863}
2021-09-24 22:37:16,609 __main__     INFO     END train.py
2021-09-25 10:52:10,121 __main__     INFO     START train.py
2021-09-25 10:52:10,122 __main__     INFO     Load train df
2021-09-25 10:52:12,267 __main__     INFO     Load validation df
2021-09-25 10:52:12,497 __main__     INFO     Input shape: (251812, 77)
2021-09-25 10:52:14,159 __main__     INFO     X_offer (247712, 74)  y_offer (247712,)	X_manual (4100, 74) y_manual (4100,)
2021-09-25 10:52:14,174 __main__     INFO     Fit model
2021-09-25 10:52:14,174 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 10:54:04,599 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 10:54:12,163 raifhack_ds.model INFO     Corr coef: -0.21
2021-09-25 10:54:12,163 __main__     INFO     Save model
2021-09-25 10:54:56,808 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5153339547593516, 'mdape': 0.3169092489500228, 'rmse': 73322.88719312495, 'r2': 0.8223657869518662, 'raif_metric': 3.5421095491197248}
2021-09-25 10:54:57,486 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2820420557749728, 'mdape': 0.2530155283857807, 'rmse': 76449.58761786461, 'r2': 0.2977886997043536, 'raif_metric': 1.9087441297619057}
2021-09-25 10:55:02,690 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6869478090444214, 'mdape': 0.3373015174479511, 'rmse': 85341.78690262868, 'r2': 0.7284743242513985, 'raif_metric': 3.7328860246503823}
2021-09-25 10:55:02,781 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3486765128127435, 'mdape': 0.23246760001250075, 'rmse': 46636.05385010823, 'r2': 0.5226379077173814, 'raif_metric': 1.879942218554027}
2021-09-25 10:55:02,781 __main__     INFO     END train.py
2021-09-25 10:56:15,454 __main__     INFO     START predict.py
2021-09-25 10:56:15,455 __main__     INFO     Load test df
2021-09-25 10:56:15,480 __main__     INFO     Input shape: (2974, 76)
2021-09-25 10:56:15,491 __main__     INFO     Load model
2021-09-25 10:56:15,528 __main__     INFO     Predict
2021-09-25 10:56:15,647 __main__     INFO     Save results
2021-09-25 10:56:15,650 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/predict.py", line 51, in <module>
    test_df[['id','per_square_meter_price']].to_csv(args['o'], index=False)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/frame.py", line 2912, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1, raise_missing=True)[1]
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/indexing.py", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/indexing.py", line 1304, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['id'] not in index"

2021-09-25 10:57:56,614 __main__     INFO     START train.py
2021-09-25 10:57:56,615 __main__     INFO     Load train df
2021-09-25 10:57:58,560 __main__     INFO     Load validation df
2021-09-25 10:57:58,794 __main__     INFO     Input shape: (251812, 77)
2021-09-25 10:58:00,444 __main__     INFO     X_offer (247712, 74)  y_offer (247712,)	X_manual (4100, 74) y_manual (4100,)
2021-09-25 10:58:00,478 __main__     INFO     Fit model
2021-09-25 10:58:00,478 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 10:59:56,326 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 11:00:04,259 raifhack_ds.model INFO     Corr coef: -0.21
2021-09-25 11:00:04,259 __main__     INFO     Save model
2021-09-25 11:00:49,874 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5153339547593516, 'mdape': 0.3169092489500228, 'rmse': 73322.88719312495, 'r2': 0.8223657869518662, 'raif_metric': 3.5421095491197248}
2021-09-25 11:00:50,623 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2820420557749728, 'mdape': 0.2530155283857807, 'rmse': 76449.58761786461, 'r2': 0.2977886997043536, 'raif_metric': 1.9087441297619057}
2021-09-25 11:00:55,735 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6869478090444214, 'mdape': 0.3373015174479511, 'rmse': 85341.78690262868, 'r2': 0.7284743242513985, 'raif_metric': 3.7328860246503823}
2021-09-25 11:00:55,809 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3486765128127435, 'mdape': 0.23246760001250075, 'rmse': 46636.05385010823, 'r2': 0.5226379077173814, 'raif_metric': 1.879942218554027}
2021-09-25 11:00:55,809 __main__     INFO     END train.py
2021-09-25 11:02:39,322 __main__     INFO     START train.py
2021-09-25 11:02:39,323 __main__     INFO     Load train df
2021-09-25 11:02:41,268 __main__     INFO     Load validation df
2021-09-25 11:02:41,479 __main__     INFO     Input shape: (251812, 77)
2021-09-25 11:02:44,230 __main__     INFO     X_offer (247712, 74)  y_offer (247712,)	X_manual (4100, 74) y_manual (4100,)
2021-09-25 11:02:44,247 __main__     INFO     Fit model
2021-09-25 11:02:44,247 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 11:04:31,326 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 11:04:38,783 raifhack_ds.model INFO     Corr coef: -0.21
2021-09-25 11:04:38,783 __main__     INFO     Save model
2021-09-25 11:05:16,507 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5153339547593516, 'mdape': 0.3169092489500228, 'rmse': 73322.88719312495, 'r2': 0.8223657869518662, 'raif_metric': 3.5421095491197248}
2021-09-25 11:05:17,158 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2820420557749728, 'mdape': 0.2530155283857807, 'rmse': 76449.58761786461, 'r2': 0.2977886997043536, 'raif_metric': 1.9087441297619057}
2021-09-25 11:05:21,609 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6869478090444214, 'mdape': 0.3373015174479511, 'rmse': 85341.78690262868, 'r2': 0.7284743242513985, 'raif_metric': 3.7328860246503823}
2021-09-25 11:05:21,676 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3486765128127435, 'mdape': 0.23246760001250075, 'rmse': 46636.05385010823, 'r2': 0.5226379077173814, 'raif_metric': 1.879942218554027}
2021-09-25 11:05:21,677 __main__     INFO     END train.py
2021-09-25 11:49:03,661 __main__     INFO     START train.py
2021-09-25 11:49:03,661 __main__     INFO     Load train df
2021-09-25 11:49:05,770 __main__     INFO     Load validation df
2021-09-25 11:49:05,983 __main__     INFO     Input shape: (251812, 77)
2021-09-25 11:49:08,442 __main__     INFO     X_offer (247712, 69)  y_offer (247712,)	X_manual (4100, 69) y_manual (4100,)
2021-09-25 11:49:08,457 __main__     INFO     Fit model
2021-09-25 11:49:08,458 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 11:50:38,419 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 11:50:45,818 raifhack_ds.model INFO     Corr coef: -0.21
2021-09-25 11:50:45,818 __main__     INFO     Save model
2021-09-25 11:51:30,977 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5241246729489482, 'mdape': 0.3155228263863128, 'rmse': 73394.10663718628, 'r2': 0.8220205426652121, 'raif_metric': 3.5270129865407336}
2021-09-25 11:51:31,627 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2812929499466945, 'mdape': 0.2494025203230424, 'rmse': 76929.28196872774, 'r2': 0.2889487935088749, 'raif_metric': 1.8988040529529333}
2021-09-25 11:51:36,335 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6898518563796465, 'mdape': 0.33316673673054054, 'rmse': 85613.74812555172, 'r2': 0.7267410088690623, 'raif_metric': 3.706536755955045}
2021-09-25 11:51:36,401 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.33240323678912215, 'mdape': 0.22164990290080758, 'rmse': 43881.28543786587, 'r2': 0.5773673739072531, 'raif_metric': 1.7383810716687855}
2021-09-25 11:51:36,402 __main__     INFO     END train.py
2021-09-25 11:58:07,466 __main__     INFO     START train.py
2021-09-25 11:58:07,467 __main__     INFO     Load train df
2021-09-25 11:58:09,463 __main__     INFO     Load validation df
2021-09-25 11:58:09,674 __main__     INFO     Input shape: (251812, 77)
2021-09-25 11:58:16,911 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 58, in <module>
    train_df = preprocess(train_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 24, in preprocess
    df1['price_type'] = df_y_resampled['price_type']
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 882, in __getitem__
    return self._get_value(key)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 990, in _get_value
    loc = self.index.get_loc(label)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/indexes/range.py", line 358, in get_loc
    raise KeyError(key)
KeyError: 'price_type'

2021-09-25 12:00:31,541 __main__     INFO     START train.py
2021-09-25 12:00:31,542 __main__     INFO     Load train df
2021-09-25 12:00:33,637 __main__     INFO     Load validation df
2021-09-25 12:00:33,875 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:00:40,920 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 58, in <module>
    train_df = preprocess(train_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 24, in preprocess
    df1['price_type'] = df_y_resampled['price_type']
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 882, in __getitem__
    return self._get_value(key)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 990, in _get_value
    loc = self.index.get_loc(label)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/indexes/range.py", line 358, in get_loc
    raise KeyError(key)
KeyError: 'price_type'

2021-09-25 12:01:12,381 __main__     INFO     START train.py
2021-09-25 12:01:12,382 __main__     INFO     Load train df
2021-09-25 12:01:14,531 __main__     INFO     Load validation df
2021-09-25 12:01:14,745 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:01:21,967 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 58, in <module>
    train_df = preprocess(train_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 25, in preprocess
    df1['price_type'] = df_y_resampled['price_type']
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 882, in __getitem__
    return self._get_value(key)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/series.py", line 990, in _get_value
    loc = self.index.get_loc(label)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/indexes/range.py", line 358, in get_loc
    raise KeyError(key)
KeyError: 'price_type'

2021-09-25 12:07:24,244 __main__     INFO     START train.py
2021-09-25 12:07:24,245 __main__     INFO     Load train df
2021-09-25 12:07:26,734 __main__     INFO     Load validation df
2021-09-25 12:07:26,959 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:07:36,261 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 12:07:36,288 __main__     INFO     Fit model
2021-09-25 12:07:36,288 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 12:09:01,471 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 12:09:02,037 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 74, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/model.py", line 170, in fit
    self._find_corr_coefficient(X_manual, y_manual)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/model.py", line 142, in _find_corr_coefficient
    predictions = self.pipeline.predict(X_manual)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/utils/metaestimators.py", line 120, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/pipeline.py", line 418, in predict
    Xt = transform.transform(Xt)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/parallel.py", line 1044, in __call__
    while self.dispatch_one_batch(iterator):
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/parallel.py", line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/parallel.py", line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/utils/fixes.py", line 222, in __call__
    return self.function(*args, **kwargs)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/pipeline.py", line 733, in _transform_one
    res = transformer.transform(X)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 136, in _transform
    raise ValueError(msg)
ValueError: Found unknown categories [1] in column 0 during transform

2021-09-25 12:11:01,524 __main__     INFO     START train.py
2021-09-25 12:11:01,525 __main__     INFO     Load train df
2021-09-25 12:11:03,654 __main__     INFO     Load validation df
2021-09-25 12:11:03,909 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:11:14,036 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 12:11:14,063 __main__     INFO     Fit model
2021-09-25 12:11:14,063 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 12:14:22,148 __main__     INFO     START train.py
2021-09-25 12:14:22,149 __main__     INFO     Load train df
2021-09-25 12:14:24,000 __main__     INFO     Load validation df
2021-09-25 12:14:24,209 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:14:33,237 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 12:14:33,269 __main__     INFO     Fit model
2021-09-25 12:14:33,269 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 12:14:40,824 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 76, in <module>
    model.fit(X_offer, y_offer, X_manual, y_manual, X_all, y_all)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/model.py", line 168, in fit
    self.pipeline.fit(X_all, y_all, model__feature_name=[f'{i}' for i in range(len(NUM_FEATURES) + len(CATEGORICAL_OHE_FEATURES) + len(CATEGORICAL_STE_FEATURES))],model__categorical_feature=[f'{i}' for i in range(len(NUM_FEATURES) + len(CATEGORICAL_OHE_FEATURES), len(NUM_FEATURES) + len(CATEGORICAL_OHE_FEATURES) + len(CATEGORICAL_STE_FEATURES))], model__eval_metric='mape')
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/sklearn/pipeline.py", line 346, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/sklearn.py", line 818, in fit
    super().fit(X, y, sample_weight=sample_weight, init_score=init_score,
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/sklearn.py", line 683, in fit
    self._Booster = train(params, train_set,
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/engine.py", line 228, in train
    booster = Booster(params=params, train_set=train_set)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/basic.py", line 2229, in __init__
    train_set.construct()
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/basic.py", line 1468, in construct
    self._lazy_init(self.data, label=self.label,
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/basic.py", line 1298, in _lazy_init
    return self.set_feature_name(feature_name)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/lightgbm/basic.py", line 1777, in set_feature_name
    raise ValueError("Length of feature_name({}) and num_feature({}) don't match"
ValueError: Length of feature_name(70) and num_feature(71) don't match

2021-09-25 12:16:10,239 __main__     INFO     START train.py
2021-09-25 12:16:10,240 __main__     INFO     Load train df
2021-09-25 12:16:12,084 __main__     INFO     Load validation df
2021-09-25 12:16:12,291 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:21:39,796 __main__     INFO     START train.py
2021-09-25 12:21:39,797 __main__     INFO     Load train df
2021-09-25 12:21:41,664 __main__     INFO     Load validation df
2021-09-25 12:21:41,880 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:21:50,922 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 12:21:50,960 __main__     INFO     Fit model
2021-09-25 12:21:50,960 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 12:24:57,076 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 12:31:32,443 __main__     INFO     START train.py
2021-09-25 12:31:32,444 __main__     INFO     Load train df
2021-09-25 12:31:35,028 __main__     INFO     Load validation df
2021-09-25 12:31:35,261 __main__     INFO     Input shape: (251812, 77)
2021-09-25 12:31:45,855 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 12:31:45,855 __main__     INFO     Save model
2021-09-25 12:31:48,172 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 12:31:48,217 __main__     INFO     Fit model
2021-09-25 12:31:48,218 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 12:32:35,925 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.6174106391197363, 'mdape': 0.3260551446214883, 'rmse': 78795.60122877323, 'r2': 0.7948594817147729, 'raif_metric': 3.6263967174283116}
2021-09-25 12:33:15,190 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.214145181147433, 'mdape': 0.18962806994865314, 'rmse': 24077.259215447015, 'r2': 0.9304770523397026, 'raif_metric': 0.9405982889335228}
2021-09-25 12:33:20,283 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.7717230544994822, 'mdape': 0.34686433148150475, 'rmse': 89254.56901264621, 'r2': 0.7030055362442866, 'raif_metric': 3.81927181885578}
2021-09-25 12:33:25,245 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.33657360314167967, 'mdape': 0.2012953798776977, 'rmse': 34558.0224438751, 'r2': 0.7527518386586395, 'raif_metric': 1.3236066924387402}
2021-09-25 12:33:25,245 __main__     INFO     END train.py
2021-09-25 12:41:56,475 __main__     INFO     START predict.py
2021-09-25 12:41:56,476 __main__     INFO     Load test df
2021-09-25 12:41:56,504 __main__     INFO     Input shape: (2974, 76)
2021-09-25 12:41:56,517 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/predict.py", line 44, in <module>
    test_df = preprocess(test_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 22, in preprocess
    df_X_resampled, df_y_resampled = ros.fit_resample(df1.drop(columns='price_type'), df1['price_type'])
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/base.py", line 79, in fit_resample
    self.sampling_strategy_ = check_sampling_strategy(
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/utils/_validation.py", line 501, in check_sampling_strategy
    raise ValueError(
ValueError: The target 'y' needs to have more than 1 class. Got 1 class instead

2021-09-25 12:44:08,104 __main__     INFO     START predict.py
2021-09-25 12:44:08,105 __main__     INFO     Load test df
2021-09-25 12:44:08,132 __main__     INFO     Input shape: (2974, 76)
2021-09-25 12:44:08,135 __main__     INFO     Load model
2021-09-25 12:44:08,177 __main__     INFO     Predict
2021-09-25 12:44:08,286 __main__     INFO     Save results
2021-09-25 12:44:08,305 __main__     INFO     END predict.py
2021-09-25 13:06:19,604 __main__     INFO     START train.py
2021-09-25 13:06:19,605 __main__     INFO     Load train df
2021-09-25 13:06:21,438 __main__     INFO     Load validation df
2021-09-25 13:06:21,660 __main__     INFO     Input shape: (251812, 77)
2021-09-25 13:06:31,309 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 13:06:31,334 __main__     INFO     Fit model
2021-09-25 13:06:31,334 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 13:09:45,872 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 13:16:32,049 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 13:16:32,050 __main__     INFO     Save model
2021-09-25 13:17:12,043 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5725275135439643, 'mdape': 0.32248840654108873, 'rmse': 76440.93663795246, 'r2': 0.8069367997412927, 'raif_metric': 3.5827033522687053}
2021-09-25 13:17:51,560 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21463647300510263, 'mdape': 0.19057613391168324, 'rmse': 24228.671910766006, 'r2': 0.9295998963593325, 'raif_metric': 0.9462424094647868}
2021-09-25 13:17:55,605 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.7379665371484427, 'mdape': 0.34113263859473425, 'rmse': 87230.56446138523, 'r2': 0.7163225562371849, 'raif_metric': 3.7639409513780486}
2021-09-25 13:17:59,545 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3331177769224468, 'mdape': 0.2048525999263556, 'rmse': 32846.06623736565, 'r2': 0.7766417312995466, 'raif_metric': 1.3051770114419303}
2021-09-25 13:17:59,545 __main__     INFO     END train.py
2021-09-25 14:35:29,035 __main__     INFO     START train.py
2021-09-25 14:35:29,036 __main__     INFO     Load train df
2021-09-25 14:35:30,933 __main__     INFO     Load validation df
2021-09-25 14:35:31,154 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:35:37,495 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (123856, 70) y_manual (123856,)
2021-09-25 14:35:37,523 __main__     INFO     Fit model
2021-09-25 14:35:37,523 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:35:47,988 __main__     INFO     START train.py
2021-09-25 14:35:47,989 __main__     INFO     Load train df
2021-09-25 14:35:50,668 __main__     INFO     Load validation df
2021-09-25 14:35:50,906 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:36:02,781 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 14:36:02,808 __main__     INFO     Fit model
2021-09-25 14:36:02,808 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:36:17,366 __main__     INFO     START train.py
2021-09-25 14:36:17,367 __main__     INFO     Load train df
2021-09-25 14:36:20,519 __main__     INFO     Load validation df
2021-09-25 14:36:20,845 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:36:22,293 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 58, in <module>
    train_df = preprocess(train_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 22, in preprocess
    df_X_resampled, df_y_resampled = ros.fit_resample(df1.drop(columns='price_type'), df1['price_type'])
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/base.py", line 79, in fit_resample
    self.sampling_strategy_ = check_sampling_strategy(
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/utils/_validation.py", line 529, in check_sampling_strategy
    raise ValueError(
ValueError: When 'sampling_strategy' is a float, it should be in the range (0, 1]. Got 2 instead.

2021-09-25 14:38:14,063 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 14:39:37,838 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 14:44:13,759 __main__     INFO     START train.py
2021-09-25 14:44:13,760 __main__     INFO     Load train df
2021-09-25 14:44:15,750 __main__     INFO     Load validation df
2021-09-25 14:44:15,965 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:44:22,045 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (123856, 70) y_manual (123856,)
2021-09-25 14:44:22,067 __main__     INFO     Fit model
2021-09-25 14:44:22,067 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:44:30,262 __main__     INFO     START train.py
2021-09-25 14:44:30,263 __main__     INFO     Load train df
2021-09-25 14:44:33,004 __main__     INFO     Load validation df
2021-09-25 14:44:33,299 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:44:45,523 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 14:44:45,587 __main__     INFO     Fit model
2021-09-25 14:44:45,587 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:45:55,961 __main__     INFO     START train.py
2021-09-25 14:45:55,962 __main__     INFO     Load train df
2021-09-25 14:45:58,931 __main__     INFO     Load validation df
2021-09-25 14:45:59,213 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:46:10,644 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (185784, 70) y_manual (185784,)
2021-09-25 14:46:10,675 __main__     INFO     Fit model
2021-09-25 14:46:10,675 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:47:17,112 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 14:49:19,981 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 14:49:56,753 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 14:52:03,956 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 14:52:03,956 __main__     INFO     Save model
2021-09-25 14:52:59,198 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5557960523316525, 'mdape': 0.3199755742899397, 'rmse': 75648.21613178773, 'r2': 0.810920309032538, 'raif_metric': 3.561133673827416}
2021-09-25 14:53:24,963 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.22354604672397937, 'mdape': 0.19705515970502024, 'rmse': 26620.824345805082, 'r2': 0.9152811370614166, 'raif_metric': 1.058683713140977}
2021-09-25 14:53:30,818 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.7135706802723052, 'mdape': 0.3388819293139452, 'rmse': 86622.8294550398, 'r2': 0.7202615461220792, 'raif_metric': 3.746752880426304}
2021-09-25 14:53:33,689 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3317239057332328, 'mdape': 0.20783105775580463, 'rmse': 34661.487393040334, 'r2': 0.7430542315039197, 'raif_metric': 1.2537631740706705}
2021-09-25 14:53:33,689 __main__     INFO     END train.py
2021-09-25 14:56:31,213 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 14:56:31,213 __main__     INFO     Save model
2021-09-25 14:56:52,290 __main__     INFO     START train.py
2021-09-25 14:56:52,292 __main__     INFO     Load train df
2021-09-25 14:56:55,824 __main__     INFO     Load validation df
2021-09-25 14:56:56,197 __main__     INFO     Input shape: (251812, 77)
2021-09-25 14:57:04,043 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (61928, 70) y_manual (61928,)
2021-09-25 14:57:04,068 __main__     INFO     Fit model
2021-09-25 14:57:04,068 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 14:57:31,665 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5656353500368738, 'mdape': 0.3215576679490565, 'rmse': 76252.79670322378, 'r2': 0.8078859822003448, 'raif_metric': 3.571133941699045}
2021-09-25 14:58:11,437 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 14:58:11,437 __main__     INFO     Save model
2021-09-25 14:58:18,521 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.2190028377246098, 'mdape': 0.19317031199467968, 'rmse': 25263.691829750802, 'r2': 0.924554199888209, 'raif_metric': 0.9873975297660886}
2021-09-25 14:58:27,452 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.730373395743651, 'mdape': 0.3391019612322694, 'rmse': 86844.72725731268, 'r2': 0.7188265236512513, 'raif_metric': 3.750888181443434}
2021-09-25 14:58:33,975 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.33948594872026144, 'mdape': 0.21256337701779346, 'rmse': 34511.7391287548, 'r2': 0.7542710421218718, 'raif_metric': 1.2778728397159695}
2021-09-25 14:58:33,975 __main__     INFO     END train.py
2021-09-25 14:59:10,500 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5725275135439643, 'mdape': 0.32248840654108873, 'rmse': 76440.93663795246, 'r2': 0.8069367997412927, 'raif_metric': 3.5827033522687053}
2021-09-25 14:59:47,224 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 15:00:04,694 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21463647300510263, 'mdape': 0.19057613391168324, 'rmse': 24228.671910766006, 'r2': 0.9295998963593325, 'raif_metric': 0.9462424094647868}
2021-09-25 15:00:10,292 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.7379665371484427, 'mdape': 0.34113263859473425, 'rmse': 87230.56446138523, 'r2': 0.7163225562371849, 'raif_metric': 3.7639409513780486}
2021-09-25 15:00:15,924 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.3331177769224468, 'mdape': 0.2048525999263556, 'rmse': 32846.06623736565, 'r2': 0.7766417312995466, 'raif_metric': 1.3051770114419303}
2021-09-25 15:00:15,925 __main__     INFO     END train.py
2021-09-25 15:01:36,835 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 15:01:36,835 __main__     INFO     Save model
2021-09-25 15:02:15,601 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.539648036912324, 'mdape': 0.31860524804649804, 'rmse': 74927.62171569362, 'r2': 0.8145053463605294, 'raif_metric': 3.551701575765413}
2021-09-25 15:02:24,997 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.23235639888055742, 'mdape': 0.20441323409519271, 'rmse': 30930.97894540135, 'r2': 0.8853399193667725, 'raif_metric': 1.1724108087457445}
2021-09-25 15:02:29,213 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.6892556920049435, 'mdape': 0.33779519262950913, 'rmse': 85951.1596639938, 'r2': 0.7245828876714355, 'raif_metric': 3.7352156750360397}
2021-09-25 15:02:30,346 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.34397069735962704, 'mdape': 0.20797025347499484, 'rmse': 39066.125507608456, 'r2': 0.6802759327631787, 'raif_metric': 1.3231458974595154}
2021-09-25 15:02:30,347 __main__     INFO     END train.py
2021-09-25 16:19:32,565 __main__     INFO     START train.py
2021-09-25 16:19:32,566 __main__     INFO     Load train df
2021-09-25 16:19:34,423 __main__     INFO     Load validation df
2021-09-25 16:19:34,712 __main__     INFO     Input shape: (251812, 77)
2021-09-25 16:20:12,294 __main__     INFO     START train.py
2021-09-25 16:20:12,295 __main__     INFO     Load train df
2021-09-25 16:20:14,191 __main__     INFO     Load validation df
2021-09-25 16:20:14,405 __main__     INFO     Input shape: (251812, 77)
2021-09-25 16:20:19,114 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (49542, 70) y_manual (49542,)
2021-09-25 16:20:19,134 __main__     INFO     Fit model
2021-09-25 16:20:19,134 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:22:06,582 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:22:51,532 raifhack_ds.model INFO     Corr coef: -0.15
2021-09-25 16:22:52,448 __main__     INFO     Save model
2021-09-25 16:22:58,466 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 62, in <module>
    train_df = preprocess(train_df, resampling_rate)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 27, in preprocess
    df1['real_floor'] = df1.floor.apply(dirty_floor_to_num)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/pandas/core/generic.py", line 5141, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'floor'

2021-09-25 16:26:23,156 __main__     INFO     START train.py
2021-09-25 16:26:23,157 __main__     INFO     Load train df
2021-09-25 16:26:25,066 __main__     INFO     Load validation df
2021-09-25 16:26:25,280 __main__     INFO     Input shape: (251812, 77)
2021-09-25 16:26:29,700 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (49542, 70) y_manual (49542,)
2021-09-25 16:26:29,721 __main__     INFO     Fit model
2021-09-25 16:26:29,721 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:28:15,920 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:28:59,705 raifhack_ds.model INFO     Corr coef: -0.15
2021-09-25 16:29:00,560 __main__     INFO     Save model
2021-09-25 16:29:06,771 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (66056, 70) y_manual (66056,)
2021-09-25 16:29:06,797 __main__     INFO     Fit model
2021-09-25 16:29:06,798 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:31:12,973 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:32:12,545 raifhack_ds.model INFO     Corr coef: -0.15
2021-09-25 16:32:13,691 __main__     INFO     Save model
2021-09-25 16:32:19,991 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (82570, 70) y_manual (82570,)
2021-09-25 16:32:20,016 __main__     INFO     Fit model
2021-09-25 16:32:20,016 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:34:21,039 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:35:31,590 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 16:35:38,830 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (99084, 70) y_manual (99084,)
2021-09-25 16:35:38,861 __main__     INFO     Fit model
2021-09-25 16:35:38,862 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:37:54,742 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:39:18,115 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 16:39:19,746 __main__     INFO     Save model
2021-09-25 16:39:27,587 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (115598, 70) y_manual (115598,)
2021-09-25 16:39:27,614 __main__     INFO     Fit model
2021-09-25 16:39:27,614 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:41:39,706 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:43:20,102 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 16:43:22,061 __main__     INFO     Save model
2021-09-25 16:43:29,328 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (132113, 70) y_manual (132113,)
2021-09-25 16:43:29,356 __main__     INFO     Fit model
2021-09-25 16:43:29,356 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:45:50,577 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:47:44,951 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 16:47:55,864 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (148627, 70) y_manual (148627,)
2021-09-25 16:47:55,893 __main__     INFO     Fit model
2021-09-25 16:47:55,893 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:50:31,611 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:51:00,039 __main__     INFO     START train.py
2021-09-25 16:51:00,040 __main__     INFO     Load train df
2021-09-25 16:51:02,964 __main__     INFO     Load validation df
2021-09-25 16:51:03,256 __main__     INFO     Input shape: (251812, 77)
2021-09-25 16:51:05,062 __main__     ERROR    Traceback (most recent call last):
  File "/home/pmolodyk/Documents/raifhack/baseline/train.py", line 58, in <module>
    train_df = preprocess(train_df)
  File "/home/pmolodyk/Documents/raifhack/baseline/raifhack_ds/features.py", line 9, in preprocess
    df_X_resampled, df_y_resampled = ros.fit_resample(df1.drop(columns='price_type'), df1['price_type'])
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/base.py", line 83, in fit_resample
    output = self._fit_resample(X, y)
  File "/home/pmolodyk/.local/lib/python3.9/site-packages/imblearn/over_sampling/_random_over_sampler.py", line 199, in _fit_resample
    for class_sample, num_samples in self.sampling_strategy_.items():
AttributeError: 'NoneType' object has no attribute 'items'

2021-09-25 16:51:36,961 __main__     INFO     START train.py
2021-09-25 16:51:36,962 __main__     INFO     Load train df
2021-09-25 16:51:39,810 __main__     INFO     Load validation df
2021-09-25 16:51:40,101 __main__     INFO     Input shape: (251812, 77)
2021-09-25 16:51:50,193 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (247712, 70) y_manual (247712,)
2021-09-25 16:51:50,210 __main__     INFO     Fit model
2021-09-25 16:51:50,211 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:53:14,427 raifhack_ds.model INFO     Corr coef: -0.14
2021-09-25 16:53:17,722 __main__     INFO     Save model
2021-09-25 16:53:26,836 __main__     INFO     X_offer (247712, 70)  y_offer (247712,)	X_manual (165141, 70) y_manual (165141,)
2021-09-25 16:53:26,873 __main__     INFO     Fit model
2021-09-25 16:53:26,873 raifhack_ds.model INFO     Fit lightgbm
2021-09-25 16:56:08,993 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:56:40,281 raifhack_ds.model INFO     Find corr coefficient
2021-09-25 16:59:45,870 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 16:59:49,382 __main__     INFO     Save model
2021-09-25 17:00:43,287 raifhack_ds.model INFO     Corr coef: -0.13
2021-09-25 17:00:43,287 __main__     INFO     Save model
2021-09-25 17:01:26,061 __main__     INFO     Metrics stat for training data with offers prices: {'mape': 1.5725275135439643, 'mdape': 0.32248840654108873, 'rmse': 76440.93663795246, 'r2': 0.8069367997412927, 'raif_metric': 3.5827033522687053}
2021-09-25 17:02:07,024 __main__     INFO     Metrics stat for training data with manual prices: {'mape': 0.21400011680776343, 'mdape': 0.18804595620455383, 'rmse': 23832.90514686409, 'r2': 0.9318810336152231, 'raif_metric': 0.9459365783743544}
2021-09-25 17:02:11,613 __main__     INFO     Metrics stat for validation data with offers prices: {'mape': 1.7379665371484427, 'mdape': 0.34113263859473425, 'rmse': 87230.56446138523, 'r2': 0.7163225562371849, 'raif_metric': 3.7639409513780486}
2021-09-25 17:02:11,683 __main__     INFO     Metrics stat for validation data with manual prices: {'mape': 0.33932928049342614, 'mdape': 0.20420443977857852, 'rmse': 32445.328354694553, 'r2': 0.768948556825616, 'raif_metric': 1.3135675184775786}
2021-09-25 17:02:11,683 __main__     INFO     END train.py
